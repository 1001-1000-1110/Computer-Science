## 파일과 디렉터리

### 파일

하드 디스크나 SSD와 같은 보조기억장치에 저장된 관련 정보의 집합(의미 있고 관련 있는 정보를 모은 논리적 단위)

- 속성(메타데이터) : 파일과 관련된 부가 정보
    
    파일 형식, 위치, 크기 등
    
- 파일 속성과 유형
    - 유형 : 운영체제가 인지하는 파일의 종류
        
        파일 이름 뒤에 확장자를 붙여 운영제체에게 파일 유형을 알려줌
        
    - 크기 : 파일의 현재 크기와 허용 가능 최대 크기
    - 보호 : 읽기, 쓰기, 실행 권한
    - 생성 날짜
    - 마지막 접근 날짜
    - 마지막 수정 날짜
    - 생성자
    - 소유자
    - 위치 : 파일의 보조기억장치상의 현재 위치

- 파일 연산을 위한 시스템 호출
    
    파일을 다루는 모든 작업은 운영체제에 의해 이루어진다.
    
    1. 파일 생성
    2. 파일 삭제
    3. 파일 열기
    4. 파일 닫기
    5. 파일 읽기
    6. 파일 쓰기

### 디렉터리

파일을 일목요연하게 관리하기 위해 사용된다. (윈도우 운영체제에서는 폴더라고 부름)

- 디렉터리 구조
    - 1단계 디렉터리
        
        하나의 디렉터리에 모든 파일이 있는 구조
        
    - 트리구조 디렉터리
        
        여러 계층의 디렉터리를 가진 구조
        
        - 루트디렉터리 : 최상위 디렉터리(/)
        
- 경로
    
    디렉터리를 이용하여 파일 위치, 나아가 파일 이름을 특정 짓는 정보
    
    → 같은 디렉터리에는 동일한 이름의 파일이 존재할 수 없지만, 서로 다른 디렉터리에는 동일한 이름의 파일이 존재할 수 있다.
    
    - 절대경로
        
        루트 디렉터리에서 자기 자신까지 이르는 고유한 경로
        
        ex) /home/minchul/a.sh
        
    - 상대경로
        
        현재 디렉터리부터 시작하는 경로
        
        ex) current : /home → minchul/a.sh
        
- 디렉터리 연산을 위한 시스템 호출
    
    파일와 마찬가지로 운영체제는 디렉터리 연산을 위한 시스템 호출도 제공한다.
    
    1. 디렉터리 생성
    2. 디렉터리 삭제
    3. 디렉터리 열기
    4. 디렉터리 닫기
    5. 디렉터리 읽기
- 디렉터리 엔트리
    
    많은 운영체제에서는 디렉터리는 특별한 형태의 파일이라고 간주한다. 파일이 내부에는 해당 파일과 관련된 정보를 담고 있다면 디렉터리는 내부에 해당 디렉터리에 담겨 있는 대상과 관련된 정보를 담는다.
    
    → 이 정보는 테이블 형태로 구성된다. 즉, 보조기억장치에 테이블 형태로 저장된다.
    
    테이블의 행을 엔트리라고 하며 엔트리에는 디렉터리에 포함된 대상의 이름과 그 대상이 보조기억장치 내에 저장된 위치를 유추할 수 있는 정보등이 담긴다
    
    - . : 현재 디렉터리
    - .. : 상위 디렉터리

## 파일 시스템

파일시스템 : 파일과 디렉터리를 보조기억장치에서 일목요연하게 저장하고 접근할 수 있게 하는 운영체제 내부 프로그램

### 파티셔닝과 포매팅

보조기억장치를 사용하려면 파티션을 나누는 작업인 파티셔닝과 포맷 작업인 포매팅을 거쳐야한다.

- 파티셔닝
    
    저장 장치의 논리적인 영역을 구획하는 작업
    
    - 파티션 : 파티셔닝 작업을 통해 나누어진 영역 하나하나
- 포매팅
    
    파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할 것인지를 결정하고 새로운 데이터를 쓸 준비를 하는 작업.
    
    - 어떤 종류의 파일 시스템을 사용할지는 바로 이 때 결정된다.
    - 파티션마다 다른 파일 시스템을 설정할 수도 있다.

### 파일 할당 방법

- 블록 : 운영체제가 파일과 디렉터리를 읽고 쓰는 단위로, 하나의 파일(+디렉토리)이 보조기억장치에 저장될 때는 하나 이상의 블록에 걸쳐 저장된다.
1. 연속 할당
    
    보조기억 장치 내 연속적인 블록에 파일을 할당하는 방식
    
    - 파일에 접근하기 위해서는 파일의 첫번째 블록 주소와 길이만 알면된다
        
    - 단점 : 외부 단편화
2. 불연속 할당
    - 연결 할당 → FAT 파일 시스템
        
        각 블록 일부에 다음 블록의 주소를 정장하여 각 블록이 다음 블록을 가리키는 형태로 할당하는 방식. 즉, 파일을 이루는 데이터를 연결 리스트로 관리한다.
        
        - 연속 할당에서 발생한 외부 단편화 문제를 해결할 수 있다.
        - 파일에 접근하기 위해서는 파일의 첫번째 블록 주소와 길이 또는 마지막 블록 주소만 알면 된다.
        
        - 단점
            1. 반드시 첫번째 블록부터 하나씩 차례대로 읽어야한다. 즉, 파일 내의 임의의 위치에 접근하는 임의 접근 속도가 매우 느리다. 첫 번째 블록부터 i번째 블록까지 일일이 순서대로 접근해야한다.
            2. 하드웨어가 고장이나 오류 발생 시 해당 블록 이후 블록은 접근할 수 없다.
    - 색인 할당 → 유닉스 파일 시스템
        
        파일의 모든 블록 주소를 색인 블록이라는 하나의 블록에 모아 관리하는 방식
        
        - 연결할당과는 달리 파일 내 임의의 위치에 접근하기 쉽다. 파일의 i번째 블록에 접근하고 싶다면 색인 블록의 i번째 항목이 가르키는 블록에 접근하면 된다.
        - 파일에 접근하기 위해서는 색인 블록 주소를 알면 된다.
        
- 파일 시스템 살펴보기
    - FAT 파일 시스템 (연결할당)
        
        연결할당의 단점을 보완한 파일 시스템
        
        → USB, SD카드 등의 저용량 저장 장치에서 사용
        
        - File Allocation Table에 각 블록에 포함된 다음 블록의 주소들을 한 곳에 모아 관리
        - FAT 파일시스템을 사용할 경우, FAT가 메모리에 캐시될 수도 있어 FAT가 메모리에 적재된 채 실행되면 다음 블록을 찾는 속도가 매우 빨라짐 → 연결할당의 1번 단점 보완
        - 특정 블록이 고장나거나 오류가 발생하더라도 FAT를 참고하여 그 다음 블록에 접근 가능 → 연결할당의 2번 단점 보완
        - 파일의 첫번째 블록 주소만 알면 파일의 데이터가 담긴 모든 블록에 접근
        - FAT12, FAT16, FAT32
            
            FAT뒤의 숫자는 블록을 표현하는 비트 수
            
        - FAT 파일시스템으로 포맷한 파티션의 구성
            
            - FAT영역
            - 루트 디렉터리 영역
            - 데이터 영역 : 서브 디렉터리와 파일들이 저장
        - FAT 파일 시스템의 디렉터리 정보
        - FAT 파일 시스템으로 포메팅된 파티션에서 특정 파일을 읽는 과정
            
            ex) /home/minchul/a.sh
            
            1. 루트디렉터리에서 home디렉터리의 3번 블록으로 이동
            2. 3번 블록에서 minchul 디렉터리의 15번 블록으로 이동
            3. 15번 에서 [a.sh](http://a.sh) 파일의 9번 블록으로 이동
            4. 9번 블록에서 차례대로 [a.sh](http://a.sh) 파일 읽기
    - 유닉스 파일 시스템 (색인할당)
        
        → 유닉스 계열 운영체제에서 사용되는 유닉스 파일 시스템
        
        - i-node : 유닉스 파일 시스템에서의 색인 블록
        - 파일마다 i-node가 존재하며 i-node마다 번호가 부여되어 있다.
        - i-node에는 파일 속성 정보와 최대 15개의 블록 주소가 저장될 수 있다.
        - 유닉스 파일시스템으로 포맷한 파티션의 구성
            
            - i-node영역 : i-node들 저장
            - 데이터 영역 : 디렉터리와 파일들 저장
        - 유닉스 파일 시스템의 디렉터리 정보
            
        - 한 파일의 블록이 15를 넘어간다면?
            1. 블록 주소 중 12개에는 직접 블록의 주소를 저장
                
                직접 블록 :  파일 데이터가 저장된 블록
                
            2. 1번 과정으로 충분하지 않다면 13번째 주소에 단일 간접 블록의 주소를 저장
                
                단일 간접 블록 : 직접 블록의 주소들이 저장된 블록
                
            3. 2번 과정으로 충분하지 않다면 14번째 주소에 이중 간접 블록 주소를 저장
                
                이중 간접 블록 : 단일 간접 블록의 주소들이 저장된 블록
                
            4. 3번 과정으로 충분하지 않다면 15번째 주소에 삼중 간접 블록 주소를 저장
                
                삼중 간접 블록 : 이중 간접 블록의 주소들이 저장된 블록
                
        - 유닉스 파일 시스템으로 포메팅된 파티션에서 특정 파일을 읽는 과정
            - 유닉스 파일 시스템은 루트 디렉터리의 i-node를 항상 기억하고 있다.
            
            ex) /home/minchul/a.sh (2번 i-node가 루트 디렉터리의 i-node라고 가정)
            
            1. 루트 i-node인 2번 i-node에서 루트 디렉터리의 1번 블록으로 이동
            2. 1번 블록에서 home디렉터리의 3번 i-node로 이동
            3. 3번 i-node에서 home디렉터리의 210번 블럭으로 이동
            4. 210번에 블록에서 minchul디렉터리의 8번 i-node로 이동
            5. 8번 i-node에서 minchul디렉터리의 121번 블록으로 이동
            6. 121번 블록에서 [a.sh](http://a.sh) 파일의 9번 i-node로 이동
            7. 9번 i-node에서 a.sh의 블록에 접근하여 차례로 읽기

<aside>
💡 이 외의 파일 시스템들

- NTFS : 윈도우 운영체제
- ext 파일시스템 : 리눅스 운영체제
</aside>

> **저널링 파일 시스템**
> 
> 저널링 기법 : 작업 로그를 통해 시스템 크래시(작업 중 컴퓨터 강제 종료)가 발생했을 때 빠르게 복구하기 위한 방법
> 
> 1. 작업 직전 파티션의 로그 영역에 변경사항에 대한 로그를 남긴다.
> 2. 로그를 남긴 후 작업을 수행한다.
> 3. 작업이 끝났다면 로그를 삭제한다.

> **마운트**
> 
> 
> 한 저장장치의 파일 시스템에서 다른 저장장치의 파일 시스템에 접근할 수 있도록 파일 시스템을 편입시키는 작업
> 
> ex) USB 메모리의 파일 시스템을 컴퓨터의 /mnt 경로에 마운트
>     -> 컴퓨터에서 /mnt 경로를 통해 USB 메모리에 접근할 수 있다.
>
