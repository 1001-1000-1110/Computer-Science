### **CPU 성능 향상 기법**

> **1. 빠른 CPU를 위한 설계 기법**
> 
> - **클럭** / clock
>     - **CPU의 속도 단위, Hz 단위로 측정**한다.
>     - 컴퓨터 부품들은 ‘클럭 신호’에 맞춰 움직인다.
>     - CPU는 ‘명령어 사이클’이라는 정해진 흐름에 맞춰 명령어를 실행한다.
>     - 클럭의 **속도는 일정하지 않다.**
>         - 일정한 속도를 유지하기 보다는 고성능을 요하는 순간, 클럭 속도를 높이고 아닌 경우에는 유연하게 클럭 속도를 낮춘다.
>         - **최대 클럭 속도를 강제로 끌어올리는 기법**을 **오버클럭킹**이라고 한다.
> - **코어와 멀티 코어** / core
>     - 클럭 속도를 높이는 방법 외 CPU의 성능을 높이는 방법
>         - **대표적으로 CPU의 코어와 스레드 수를 늘리는 방법이 있다.**
>     - **코어**
>         - 명령어를 실행하는 부품 → **명령어를 실행하는 부품을 여러 개 포함하는 부품**으로 명칭의 범위가 확장되었다.
>         - 중요한 것은 코어마다 **처리할 명령어들을 얼마나 적절하게 분배**하느냐이고 이에 따라 연산 속도는 크게 차이난다.
>     - **멀티 코어 CPU / 멀티 코어 프로세스**
>         - **코어를 여러 개 포함하고 있는 CPU**
>         - 명령어를 실행할 수 있는 하드웨어 부품이 CPU 안에 두 개 이상 있는 CPU
> - **스레드** / thread
>     - 스레드의 사전적 의미는 **실행 흐름 단위**이다.
>         1. **하드웨어적 스레드**
>             - **하나의 코어가 동시에 처리하는 명령어 단위**
>             - **하나의 코어로 명령어를 동시에 처리하는 CPU**를 **멀티 스레드 프로세서 or 멀티 스레드 CPU**라고 한다.
>                 - 하이퍼스레딩 : 인텔의 멀티스레드 기술
>             - **멀티 스레드 프로세서**
>                 - 멀티 스레드 프로세서의 가장 큰 핵심은 **레지스터**이다.
>                     - 하나의 명령어를 처리하기 위해 꼭 필요한 레지스터를 여러 개 가지고 있으면 되기 때문이다.
>                 - 하드웨어 스레드를 이용해 하나의 코어로 여러 명령어를 처리할 수 있다.
>                 - 이 말은 메모리 속 프로그램 입장에서 봤을 때 하드웨어 스레드는 마치 **‘한 번에 하나의 명령어를 처리하는 CPU’**나 다름 없다.
>                 - 이 때문에 하드웨어 스레드를 **논리 프로세서**라고 부른다.
>         2. **소프트웨어적 스레드** 
>             - **하나의 프로그램에서 독립적으로 실행되는 단위**

> **2. 빠른 CPU를 위한 명령어 병렬 처리 기법**
> 
> - **명령어 병렬 처리 기법**
>     - **명령어를 동시에 처리**하여 CPU를 한시도 쉬지 않고 작동시키는 기법
>         1. **명령어 파이프 라이닝**
>             - 명령어들을 **명령어 파이프 라인에 넣고 동시에 처리하는 기법**
>             - 명령어 **처리 과정**
>                 1. 명령어 인출 / Instruction Fetch
>                 2. 명령어 해석 / Instruction Decode
>                 3. 명령어 실행 / Execute Instruction
>                 4. 결과 저장 / Write Back
>             - 높은 성능을 가져오지만, 특정 상황에서는 성능 향상에 실패하는 경우도 있다.
>             - 실패한 경우를 **파이프 라인 위험**이라고 부른다.
>             - **파이프 라인 위험 종류**
>                 1. **데이터 위험**
>                     - 명령어 간 **‘데이터 의존성’**에 의해 발생한다.
>                 2. **제어 위험**
>                     - 분기 등으로 인한 **‘프로그램 카운터의 갑작스러운 변화’**에 의해 발생한다.
>                     - 이를 방지 위해 **분기 예측**이라는 기술을 사용한다.
>                         - 어디로 분기할지 미리 예측한 후 그 주소를 인출한다.
>                 3. **구조적 위험 / 자원 위험**
>                     - 명령어들을 겹처 실행하는 과정에서 서로 다른 명령어가 동시에 ALU, 레지스터 등과 같은 CPU 부품을 사용하려고 할 때 발생한다.
>         2. **슈퍼스칼라**
>             - 오늘날 대부분의 CPU에서는 여러 개의 파이프 라인을 이용한다.
>             - **CPU 내부에 여러 개의 명령어 파이프 라인을 포함한 구조**
>             - 슈퍼스칼라 구조로 명령어 처리가 가능한 CPU를 **슈퍼 스칼라 프로세서 or 슈퍼 스칼라 CPU**라고 한다.
>         3. **비순차적 명령어 처리** 
>             - **명령어들을 순차적으로 실행하지 않는 기법**
>             - 순차적으로만 실행하지 않고 **순서를 바꿔 실행해도 무방한 명령어들을 먼저 실행**하여 명령어 파이프 라인이 멈추는 것을 방지하는 기법이다.
>             - 비순차적 명령어 처리가 가능한 CPU는 명령어들이 어떤 명령어와 데이터 의존성을 가지고 있는지, 순서를 바꿔 실행할 수 있는 명령어에는 어떤 것들이 있는지 판단할 수 있어야 한다.

> **3. RISC와 CISC의 차이**
> 
> - 명령어 파이프 라이닝과 슈퍼스칼라 기법을 실제로 CPU에 적용하기 위해서는 **명령어가 파이프 라이닝에 최적화**되어 있어야 한다. 즉 실행하는 명령어가 파이프 라이닝 하기 쉽게 생겨야 한다.
> - **명령어 집합**
>     - **CPU가 이해할 수 있는 명령어들의 모음**을 **명령어 집합 or 명령어 집합 구조**라고 한다.
>         - 명령어 집합에 구조라는 단어가 붙은 이유는 CPU가 어떤 명령어를 이해하는지에 따라 컴퓨터 구조 및 설계 방식이 달라지기 때문이다.
>         - **ISA가 다르다**는 것은 CPU가 이해할 수 있는 **명령어가 다르다**는 뜻이고, 명령어가 달라지면 **어셈블리어도 달라지게 된다.**
>         - **ISA는 일종의 CPU 언어인 셈이다.**
>         - ISA가 다르면 그에 따른 나비 효과로 많은 것이 달라진다. 이는 CPU 하드웨어 설계에도 큰 영향을 미친다.
> - **CISC / Complex Instruction Set Computer**
>     - **복잡한 명령어 집합을 활용하는 컴퓨터**
>     - CISC는 **다양하고 강력한 기능의 명령어 집합을 활용**하기 때문에 명령어의형태와 크기가 다양한 **가변 길이 명령어를 활용**한다.
>     - 다양하고 강력한 기능의 명령어를 활용한다는 말은 **상대적으로 적은 수의 명령어로도 프로그램을 실행**할 수 있다는 의미이다.
>     - 프로그램을 실행하는 명령어 수가 적다는 것은 **‘컴파일 된 프로그램의 크기가 작다’**는 것을 의미한다.
>         - 같은 소스코드를 컴파일해도 CPU마다 생성되는 실행 파일의 크기가 다를 수 있다.
>     - 적은 수의 명령어로 프로그램을 실행시킬 수 있기 때문에 **메모리 공간을 절약할 수 있다**는 장점이 있다.
>     - 하지만 CISC는 명령어의 크기와 실행되기까지의 **시간이 일정하지 않다.**
>     - 복잡한 명령어 때문에 **명령어 하나를 실행하는데 여러 클럭 주기를 필요**로 한다.
>     - **규격화 되지 않은 명령어가 파이프 라이닝을 어렵게 만든다.**
>     - 게다가 명령어의 집합이 다양하고 복잡한 기능을 지원하지만 **실제 자주 사용되는 명령어만 쓰인다.**
> - **RISC / Reduce Instruction Set Computer**
>     - **CISC의 한계를 극복**하기 위해 **‘원활한 파이프 라이닝을 위해 명령어의 길이와 수행 시간은 짧고 규격화 되어야 한다’, ‘자주 쓰이는 기본적인 명령어를 작고 빠르게 만드는 것이 중요하다’**는 원칙을 가지고 RISC가 만들어지게 되었다.
>     - 때문에 RISC는 **되도록 1클럭 내외로 실행되는 명령어를 지향**한다. 즉 **고정 길이 명령어를 활용**한다.
>     - 명령어가 규격화 되어 있고, 하나의 명령어가 1클럭 내외로 실행되므로 **RISC 명령어 집합은 파이프 라이닝에 최적화 되어 있다.**
>     - **메모리 접근을 단순화하고 최소화**를 추구한다. 이런 점에서 RISC를 **load-store 구조**라고 부른다.
>     - 메모리 접근을 단순, 최소화하는 대신 **레지스터를 적극적으로 활용**한다.
>     - CISC보다 레지스터를 이용하는 연산이 많고 일반적인 경우보다 범용 레지스터 개수도 많다. 때문에 **RISC는 CISC보다 많은 명령어로 프로그램을 작동시킨다.**