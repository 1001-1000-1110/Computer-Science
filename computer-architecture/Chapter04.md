##  ALU와 제어장치
- - -
### ALU
ALU는 레지스터를 통해 피연산자를 받아들이고, 제어장치로부터 수행할 연산을 알려주시는 제어신호를 받아들입니다. 연산을 수행한 결과는 숫자, 문자 그리고 메모리 주소가 될 수 있습니다. 이러한 결과는 일시적으로 레지스터에 저장됩니다.
-> cpu가 메모리에 접근하는 속도보다 레지스터에 접근하는 속도가 더 빠르기 때문입니다.
- 플래그(flag) : ALU가 내보내는 정보로 연산결과에 대한 추가적인 상태정보를 나타냅니다.
  - 부호플래그,제로플래그,캐리플래그,오버플로우플래그,인터럽트 플래그, 슈퍼바이저플래그 등이 있습니다.
  - *오버플로우(Overflow) : 연산결과가 연산결과를 담은 레지스터보다 큰 상황.
## 제어장치
제어장치는 제어신호를 내보내고, 명령어를 해석하는 부품입니다. 
- 제어장치는 클럭신호를 받는다.  
  - 클럭(clock)이란 컴퓨터의 부품들을 동작하게하는 시간 단위입니다.
- 제어장치는 해석해야할 명령어를 받는다.
  - cpu가 해석해야하는 명령어는 `명령어 레지스터`에 저장됩니다. 제어장치는 이 장치로부터 해석할 명령어를 받아들이고, 해석한뒤 제어신호를 발생시켜 컴퓨터 부품에게 전달합니다.
- 제어장치는 플래그 레지스터 속 플래그 값을 받는다.
- 제어장치는 시스템버스 중 제어버스를 통해 제어신호를 받는다.
  - 제어신호는 cpu뿐만 아니라 외부장치(입출력장치)등에서도 발생합니다. 이러한 외부장치와 제어 신호를 주고받을때 제어버스를 이용합니다.
## 레지스터
- 프로그램카운터(PC : program counter)
  - 메모리에서 읽어 들일 명령어의 주소를 저장하는 레지스터
- 명령어레지스터(IR: Instruction Register)
  - 메모리에서 읽어들인 명령어를 저장하는 레지스터
- 메모리 주소 레지스터(MAR: Memory Address Register)
  - 메모리의 주소를 저장하는 레지스터
  - cpu가 메모리에 읽어들이고자하는 주소를 주소버스를 통해 보낼 때 사용된다.
- 메모리 버퍼 레지스터(MBR : Memory Buffer Register)
  - 메모리와 주고받을 값을 저장하는 레지스터
  - cpu가 데이터버스를 통해 메모리와 데이터를 주고 받을 때 사용됩니다.
- 범용 레지스터(general purpose register)
  - 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터로, 데이터와 주소를 보두 저장할 수 있다.
  - 현대 대다수의 cpu가 이를 갖추고 있다.
- 플래그 레지스터(flag register)
  - 연산결과 또는 cpu 상태에 대한 부가적인 정보를 저장하는 레지스터

## 레지스터를 이용한 주소지정방식
- - -
### 스택 주소 지정 방식
`스택`과 `스택포인터`를 이용한 주소 지정방식입니다. 
- 스택: 가장 마지막에 저장한 값을 우선적으로 꺼낼 수 있는 구조로, 메모리의 스택영역을 이와 구조로 사용함.
- 스택포인터: 스택의 꼭대기를 가리키는 레지스터,즉 스택에 마지막으로 저장된 값의 위치를 저장하는 레지스터
### 변위 주소 지정방식
오퍼랜드 필드의 값과 특정레지스터의 값을 더하여 유효주소를 얻어내는 주소 지정 방식입니다.  
이 변위 주소 지정방식에 사용되는 명령어는 `연산코드필드` + `레지스터필드` + `오퍼랜드필드` 로 구성되어있습니다.
오퍼랜드 필드의 주소에 어떤 레지스터를 더하는지에 따라 `상대 주소 지정 방식`, `베이스 레지스터 주소 지정 방식` 등으로 나뉩니다.
- 상대 주소 지정 방식(relative addressing mode)
  - 오퍼랜드와 `프로그램 카운터`의 값을 더하여 유효주소를 얻는 방식.
  - 모든 코드를 실행하는 것이 아닌, 분기하여 특정주소의 코드를 실행할 때 사용됨.
- 베이스 레지스터 주소 지정 방식(base-register addressing mode)
  - 오퍼랜드와 `베이스 레지스터`의 값을 더하여 유효주소를 얻는방식

## 명령어 사이클과 인터럽트
- - -
- 명령어 사이클 
  - cpu가 하나의 명령어를 처리하기 위한 정형화된 흐름 
  - 명령어 사이클 : cpu가 명령어를 처리하는 일정한 주기.
- 인터럽트 : cpu는 정해진 흐름에 따라 명령어를 처리하는데, 이를 멈추게하는 신호
### 명령어 사이클
- 인출 사이클(fetch cycle)  
  cpu가 메모리에 있는 명령어를 가져오는 단계
- 실행 사이클(execution cycle)  
  cpu에 가져온 명령어를 실행하는 단계
- 간접 사이클(indirect cycle)  
  간접주소방식 등은 오퍼랜드 필드에 `유효주소의 주소`를 명시기때문에, 메모리에 접근이 한차례 더 필요한 경우에 실행되는 단계

### 인터럽트
인터럽트는 크게 동기인터럽트와 비동기인터럽트로 구성되어 있습니다. 
- 동기인터럽트(=예외)  
  cpu에 의해 발생하는 인터럽트로, cpu가 실행하는 프로그램의 오류와 같은 예외적인 상황에 발생하며 예외(exception)이라고 부른다.
  - 폴트(fault)  
  예외를 처리한 직후 예외가 발생한 명령어부터 실행을 제게하는 예외  
  ex) cpu가 명령어를 실행하기 위해 메모리에 접근했지만, 필효한 내용이 보조기억장치에 있을 경우, `폴트`를 발생시키고 해당 내용을 보조기억장치로 부터 메모리에 옮긴 후 다시 실행한다.
  - 트랩(trap)  
  예외를 처리한 직후 예외가 발생한 명령어의 다음 멸령어부터 재개하는 예외  
  ex)디버깅
  - 중단(abort)
  cpu가 실행중인 프로그램을 강제로 중단 시킬 수 밖에없는 심각한 오류를 발생했을 경우 발생하는 예외
  - 소프트웨어 인터럽트(software interrupt)  
  시스템 호출이 발생했을 경우 나타남.
  
- 비동기인터럽트(=하드웨어 인터럽트)  
  - 주로 입출력 장치에 의해 발생하는 인터럽트(하드웨어 인터럽트)
  - 인터럽트 처리 순서
    1. 입출력장치가 cpu에 인터럽트 요청신호를 보낸다.
    2. cpu는 `실행사이클`이 끝나면 인터럽트 여부를 확인한다.
    3. cpu는 인터럽트 요청을 확인하고 `인터럽트 플래그`를 통해 인터럽트를 받아들일 수 있는 지 확인한다.
    4. 인터럽트를 받아들일 수 있다면, cpu는 지금까지의 작업을 백업한다.
    5. cpu는 `인터럽트 벡터`를 참조하여 `인터럽트 서비스 루틴`을 실행한다.
    6. 인터럽트 서비스 루틴이 끝나면 백업했던 작업을 복구하여 재실행한다.  
  *`인터럽트 벡터`: 인터럽트 서비스 루틴을 식별하기 위한 정보로, 인터럽트 서비스 루틴의 시작주소를 알려준다.  
  *`인터럽트 서비스 루틴`: 인터럽트를 처리하기 위한 프로그램

