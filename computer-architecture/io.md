여기서 말하는 입출력장치는 보조기억장치도 포함한다.

## 장치 컨트롤러와 장치 드라이버

- 장치 컨트롤러
    
    
    > 입출력장치는 너무나도 다양해서 규격화가 어렵고 데이터 전송률(데이터 교환 속도)CPU와 메모리의 데이터 전송률보다 현저히 낮다.
    > 
    
    모든 입출력장치는 각자의 장치 컨트롤러를 통해 넘퓨터 내부와 정보를 주고받는다. 장치 컨트롤러는 하나 이상의 입출력장치와 연결되어 있다.
    
    - 장치 컨트롤러의 역할
        - CPU와 입출력 장치간의 통신 중개
            
            장치 컨트롤러가 일종의 번역가 역할을 해줌
            
        - 오류 검출
            
            자신과 연결된 입출력장치에 문제가 없는지 오류를 검출해줌
            
        - 데이터 버퍼링
            
            전송률이 높은 CPU와 전송률이 낮은 입출력장치와의 전송률 차이를 데이터 버퍼링으로 완화해줌
            
            > **버퍼링**
            > 
            > 
            > 전송률이 높은 장치와 낮은 장치 사이에 주고받는 데이터를 버퍼라는 임시 공간에 저장하여 전송률을 비슷하게 맞추는 방법
            > 
    - 장치 컨트롤러의 내부
        
        - 데이터 레지스터
            
            CPU와 입출력장치 사이에 주고받을 데이터가 담기는 레지스터, 버퍼의 역할을 한다. 데이터가 많을 경우 레지스터 대신 RAM을 사용하기도 한다.
            
        - 상태 레지스터
            
            입출력을을 할 준비/작업완료/오류 유무등의 상태 정보가 저장
            
        - 제어 레지스터
            
            입출력장치가 수행할 내용에 대한 정보와 명령을 저장
            
- 장치 드라이버
    
    장치 컨트롤의 동작을 감지하고 제어함으로써 장치 컨트롤러가 컴퓨터 내부와 정보를 주고받을 수 있게하는 프로그램
    
    - 새로운 장치를 컴퓨터에 연결하면 장치 드라이버를 설치해야함
    - 프로그램이기 때문에 실행과정에서 메모리에 적재됨
    - 장치 컨트롤러가 하드웨어적 통로라면 장치 드라이버는 소프트웨어적 통로
    - 컴퓨터(운영체제)가 연결된 장치의 드라이버를 인식하고 실행할 수 있다면 그 장치는 컴퓨터 내부와 정보를 주고받을 수 있다.
    - 장치 드라이버는 운영체제가 기본으로 제공한느 것도 있지만 장치 제작자가 따로 제공하기도한다.

## 다양한 입출력 방법

입출력 작업을 수행하기 위해선 CPU와 장치 컨트롤러가 정보를 주고받아야한다. 정보를 주고받는 방법에는 프로그램 입출력, 인터럽트 기반 입출력, DMA 입출력이 있다.

- 프로그램 입출력
    
    프로그램 속 명령어로 입출력장치를 제어하는 방법으로 CPU가 프로그램 속 명령어를 실행하는 과정에서 입출력 명령어를 만나면 CPU는 입출력 장치에 연결된 장치 컨트롤러와 상호작용하며 입출력 작업을 수행한다. CPU는 장치 컨트롤러의 레지스터에 접근하여 값을 읽고 쓰며 입출력 작업을 수행한다.
    
    > **폴링**
    > 
    > 
    > 프로그램 입출력에서 CPU는 주기적으로 장치 컨트롤러의 상태 레지스터는 확인하며 입출력 장치의 상태를 확인하는데 이처럼 주기적으로 어떠한 상태를 확인하는 것을 폴링이라고한다. 이 방식은 인터럽트 방식보다 CPU의 부담이 더 크다. 
    > 
    - CPU가 장치 컨트롤러의 레지스터에 접근하는 방법
        1. 메모리맵 입출력
            
            메모리에 접근하기 위한 주소 공간과 입출력장치에 접근하기 위한 주소 공간을 하나의 주소 공간으로 간주하는 방법으로 **CPU는 메모리의 주소들이나 장치 컨트롤러의 레지스터들이나 모두 똑같은 메모리 주소를 대하듯이 하면 된다**
            
        2. 고립형 입출력
            
            메모리를 위한 주소 공간과 입출력장치를 위한 주소 공간을 분리하는 방법으로 **CPU는 입출력 장치에 접근하기 위해 메모리에 접근하는 명령어와 다른 입출력 명령어를 사용한다.**
            
    
- 인터럽트 기반 입출력
    
    CPU가 컨트롤러에 입출력 작업을 명령하고 장치 컨트롤러가 입출력장치를 제어하며 입출력을 수행하는 동안 CPU는 다른일을 하며, 장치 컨트롤러가 입출력 작업을 끝낸 후 CPU에게 인터럽트 요청신호를 보내면 CPU는 하던 일을 백업하고 인터럽트 서비스 루틴을 실행한다.
    
    - 여러 입출력 장치에서 인터럽트가 동시에 발생한 경우
        1. 발생한 순서대로 인터럽트 처리 (by 인터럽트 비트 비활성화)
        2. 우선순위를 고려한 인터럽트 처리
            
            **프로그래머블 인터럽트 컨트롤러 하드웨어(PIC)**는 인터럽트 요청들의 우선순위를 판별한 뒤 CPU에 지금 처리해야 할 하드웨어 인터럽트는 무엇인지 알려준다. PIC의 각각의 핀들은 장치 컨트로들과 연결되어 있다. (참고로 무시할 수 없는 인터럽트인 NMI는 우선순위가 가장 높아 우선순위 판별이 불가능 하기 때문에 PIC는 NMI는 판별하지 않는다.)
            
            - PIC의 다중 인터럽트 처리 과정
                1. PIC가 장치 컨트롤러에서 인터럽트 요청 신호들을 받아들인다.
                2. PIC는 우선순위를 판단한 뒤 CPU에게 처리해야할 인터럽트 요청 신호를 보낸다.
                3. CPU는 PIC에 인터럽트 확인 신호를 보낸다.
                4. PIC는 데이터 버스를 통해 CPU에 인터럽트 벡터를 보낸다.
                5. CPU는 인터럽트 벡터로 얻은 인터럽트 서비스 루틴을 실행시킨다.
- DMA 입출력
    
    
    프로그램기반 입출력과 인터럽트 기반 입출력은 입출력 장치와 메모리간의 데이터 이동을 하기 위해선 CPU는 반드시 거치게되며 CPU의 부담이 크다. DMA(Direct Memory Access)는 입출력장치와 메모리가 CPU를 거치지 않고도 상호작용 할 수 있는 입출력방식이다. DMA입출력을 하기 위해선 시스템 버스에 연결된 DMA컨트롤러가 필요하다.
    
    - DMA 입출력 과정
        1. CPU는 DMA 컨트롤러에 입출력장치의 주소, 연산, 메모리주소 등과 같은 정보로 입출력 작업을 명령한다.
        2. DMA 컨트롤러는 CPU대신 장치 컨트롤러와 상호작용하며 입출력 작업을 수행한다. DMA는 필요한 경우 메모리에 접근도 가능하다.
        3. 입출력 작업이 끝나면 DMA컨트롤러는 CPU에 인터럽트를 걸어 작업이 끝남을 알린다.
    
    → 하지만 시스템 버스는 동시 사용이 불가능하다. 시스템 버스는 공용자원이기 때문이다. DMA를 위해 시스템 버스를 너무 자주 사용하면 그만큼 CPU가 시스템 버스를 이용하지 못하게 된다. DMA컨트롤러와 장치 컨트롤러들은 **입출력 버스**라는 별도의 버스에 연결하여 해결할 수 있다
