# CPU 성능 향상 기법
## 빠른 CPU를 위한 설계 기법
- - -
### 클럭
컴퓨터는 클럭신호에 맞춰 움직입니다. 따라서 클럭속도가 높아지면 cpu는 더빠르게 명령어 사이클을 수행할 것입니다.
클럭의 속도는 일정하지 않습니다. 고성능이 필요한 순간에 빨라지며, 반대로 느려지기도 합니다.
하지만 클럭속도의 향샹만으로 cpu성능을 증가시키는 데에는 한계가 있습니다. 발열이 심해지기 때문입니다.

### 코어와 멀티코어
- 코어 : 명령어를 실행하는 부품(흔히 알고있던 cpu의 정의입니다. 기술의 고도화로 현재는 cpu는 여러개의 코어를 가지고 있습니다.)
- 멀티코어(멀티코어 프로세스) : 코어를 여러개 포함하고 있는 cpu를 칭합니다. 

### 스레드와 멀티스레드
스레드
1. 하드웨어적 스레드  
    - 하나의 코어가 동시에처리하는 명령어의 단위 
   - 하나의 코어로 여러 명령어를 동시에 처리하는 cpu를 `멀티스레드 프로세서` 또는 `멀티스레드cpu`라고 함.
   >  2코어 4스레드 -> 2개의 코어로 4개의 명령어를 처리할 수 있는 cpu

2. 소프트웨어적 스레드
    - 하나의 프로그램에서 독리적으로 실행되는 단위

### 멀티스레드 프로세서
- 멀티코어 프로세서: 명령어를 실행할 수 있는 하드웨어 부품을 2개 이상가진 cpu
- 멀티스레드 프로세서: 하나의 코어로 여러개의 명령어를 동시에 실행하는 cpu
- *코어 : 명령어를 실행할 수 있는 하드웨어 부품
- *스레드: 명령어를 실행하는 단위

## 명령어 병렬 처리 기법(ILP: instruction-level parallelism)
`명령어 병렬 처리 기법`은 cpu가 명령어를 동시에 처리하도록 작동시키는 기법입니다.
- - -
### 명령어 파이프라이닝
명령어 처리 과정을 클럭 단위로 나누면 다음과 같이 구분됩니다.
1. 명령어 인출(Instruction Fetch)
2. 명령어 해석(Instruction Decode)
3. 명령어 실행(Execute Instruction)
4. 결과 저장(Write Back)
`명령어파이프라인`을 통해 같은 단계가 겹치지 않는 다면, cpu는 각단계를 동시에 실행할 수 있습니다.
이를 사용한 기법을 `명령어파이프라이닝`이라고합니다.

- 파이프라인 위험(pipeline hazard)
1. 데이터 위험  
    데이터간의 의존성으로 인해발생하는 문제로, 어떤 명령어는 이전 명령어가 완료되어야 수행할 수 있는 명령어가 파이프라이닝을 통해 동작할 때 발생합니다.
2. 제어 위험  
    분기 등으로 '프로그램 카운터'의 갑작스러운 변화에 의해 발생하면, 파이프라인에서 미리처리하던 명령어들이 쓸모가 없어지는 문제.  
    -> 프로그램이 어디로 분기할지 미리 예측한 후 그 주소를 인출하는`분기 예측(branch prediction)`이 대안이 됩니다.
3. 구조적 위험
    명령어들이 겹처 실행하는 과정에서, 서로 다른 명령어가 동시에 cpu등 자원을 사용하려고 할때 발생하는 위험입니다.

### 슈퍼 스칼라
cpu내부에 여러개의 명령어 파이프라인을 포함한 구조를 말합니다. 이러한 구조로 명령어처리가 가능한 cpu를 `슈퍼스칼라 프로세서`,`슈퍼스칼라 cpu`라고 합니다.
`멀티스레드 프로세서`는 한번에 여러 명령어를 인출,해석,실행할 수 있기 때문에 `슈퍼스칼라` 구조를 사용할 수 있습니다.  

이론적으로는 파이프라인의 개수에 비례하여 프로그램 처리 속도가 증가하지만, 파이프라인 위험등 많은 문제를 고려해야합니다.

### 비순차적 명령어 처리
- 비순차적 명령어처리(OoOe:Out of Order execution)
  - 오늘날 cpu성능 향상에 크게 기여한 기법
  - 명령어를 순차적으로 실행하지 않는 기법
  - 데이터의 의존성이 전혀없는 명령어의 경우, 순서에 영향을 미치지 않으므로 먼저 실행하여 파이프라인이 멈추는 현상을 방지하는 기법입니다.

## CISC와 RISC
파이프라이닝, 슈퍼스칼라등의 방식을 효과적으로 사용하려면, cpu가 인출, 해석, 실행하는 명령어가 이에 적합해야합니다.
- - -
### CISC(Complex Instuction Set Computer)
- 복잡하고 다양한 명령어
- 가변 길이 명령어
- 다양한 주소 지정방식
- 프로그램을 이루는 명령어의 수가 적음
- 여러 클럭에 걸쳐 명령어 수행
- 파이프라이닝하기 어려움

### RISC(Reduced Instruction Set Computer)
- 단순하고 적은 명령어
- 고정길이 명령어
- 적은 주소 지정 방식
- 프로그램을 이루는 명령어의 수가 ㅁ낳음
- 1클럭 내외로 명령어 수행
- 파이프라이닝하기 쉬움
