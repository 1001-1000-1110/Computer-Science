### 교착 상태

> **1. 교착 상태란**
> 
> - **일어나지 않을 사건을 기다리며 진행이 멈춰 버리는 현상**을 교착상태라고 한다.
> - 뮤텍스 락에서도 교착 상태는 발생할 수 있다.
> - **자원 할당 그래프**
>     - 교착 상태는 **자원 할당 그래프를 통해 단순하게 표현**할 수 있다.
>     - **어떤 프로세스가 어떤 자원을 사용하고 있고, 또 어떤 프로세스가 어떤 자원을 기다리고 있는지 표현하는 간단한 그래프이다.**
>     - 프로세스는 원으로, 자원의 종류는 사각형으로 표현한다. 
>     - 사용할 수 있는 자원의 개수를 자원 사각형 내에 점으로 표현한다. 
>         - 같은 자원이라 할지라도 사용 가능한 자원의 개수는 여러 개 있을 수 있다.
>     - 프로세스가 어떤 자원을 할당 받아 사용 중이라면 자원에서 프로세스를 향해 화살표 표시를 한다.
>     - 프로세스가 어떤 자원을 기다리고 있으면 프로세스에서 자원을 화살표로 표시한다. 
> - **교착 상태가 발생한 상황은 자원 할당 그래프가 원의 형태를 띄고 있다.**
> - **교착 상태 발생 조건**
>     - **상호 배제**
>         - 우선 교착 상태가 발생한 근본적인 원인은 해당 자원을 한 번에 하나의 프로세스만 이용 가능했기 때문이다.
>         - 프로세스도 마찬가지로 한 프로세스가 사용하는 자원을 다른 프로세스가 사용할 수 없을 때, 즉 상호 작용 배제 상황에서 교착 상태가 발생할 수 있다.
>     - **점유와 대기**
>         - 자원을 보유한 채 다른 자원을 기다렸기 때문에 발생한다.
>     - **비선점**
>         - 프로세스가 자원을 비선점 하는 경우 발생한다.
>         - 즉 어떤 프로세스도 다른 프로세스의 자원을 강제로 빼앗지 못했기 때문에 교착 상태가 발생했다고 볼 수 있다.
>     - **원형 대기**
>         - 프로세스들과 프로세스가 요청 및 할당받은 자원이 원의 형태를 이루었기 때문에 발생한다.

> **2. 교착 상태 해결 방법**
> 
> - 운영체제는 교착상태가 일어나지 않도록 교착 상태 발생 조건에 부합하지 않게 자원을 분배하여 교착 상태를 예방할 수 있고, 교착 상태 위험 시 자원을 할당하지 않는 방식으로 회피할 수 있다.
> - 또한 자원을 제약없이 할당하다가 교착 상태가 검출되면 교착 상태를 회복하는 방법을 취할 수 있다.
> - **교착 상태 예방**
>     - 자원 상호 배제 → 현실에서 사용하기에는 무리가 있다.
>     - 점유와 대기 삭제 → 자원의 활용률이 낮아지고, 많은 자원을 사용하는 프로세스는 불리해진다. (많은 자원을 사용하게 되면 무한정 대기 == 기아 현상을 야기)
>     - 비선점 조건 삭제 → 선점하여 사용할 수 있는 일부 자원에서는 효과적
>     - 원형 대기 조건 삭제 → 모든 자원에 라벨링은 단순하지 않고, 자원의 번호에 따라 활용률이 떨어질 가능성이 높다.
>     - **교착 상태의 발생 조건을 원천적으로 제거해 사전에 방지하는 예방은 교착 상태가 발생하지 않음을 보장할 수는 있지만 부작용이 많다.**
> - **교착 상태 회피**
>     - 교착 상태 회피는 **교착 상태가 발생하지 않을 정도로만 조심스럽게 자원을 할당하는 방식**이다.
>     - 회피 방식에는 교착 상태를 한정된 자원의 무분별한 할당으로 인해 발생하는 문제로 간주한다.
>     - **안전 상태**
>         - 교착 상태가 발생하지 않고 모든 프로세스가 정상적으로 자원을 할당받고 종료될 수 있는 상태
>     - **불안전 상태**
>         - 교착 상태가 발생할 수도 있는 상태
>         - 안전 순서열이 없는 상황
>     - **안전 순서열**
>         - 교착 상태 없이 안전하게 프로세스들에 자원을 할당할 수 있는 순서
>     - 운영체제가 교착 상태를 회피하기 위해서는 시스템 상태가 안전 상태에서 안전 상태로 움직이는 경우에만 자원을 할당하면 된다.
>     - **교착 상태 회피 방식은 항시 안전 상태를 유지하도록 자원을 할당하는 방식**이라고 볼 수 있다.
> - **교착 상태 검출 후 회복**
>     - **교착 상태 검출 후 회복은 교착 상태 발생을 인정하고 사후에 조치하는 방식**으로 검출 후 회복 방식에서 운영체제는 프로세스들이 자원을 요구할 때마다 그때그때 모두 할당하며 발생 여부를 주기적으로 검사한다.
>     - **선점을 통한 회복**
>         - **선점을 통한 회복은 교착 상태가 해결될 때까지 한 프로세스씩 자원을 몰아주는 방식**이다.
>         - 해결될 때까지 **다른 프로세스로부터 자원을 강제로 빼앗고 한 프로세스에 할당**한다.
>     - **프로세스 강제 종료를 통한 회복**
>         - 프로세스 강제 종료를 통한 회복은 가장 단순하면서 확실한 방식이다.
>         - **운영체제는 교착 상태에 놓인 프로세스를 모두 강제종료** 할 수 있다.
